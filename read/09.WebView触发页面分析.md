#### 基础使用目录介绍
- 01.触发加载网页的行为




### 01.触发加载网页的行为
- 触发加载网页的行为主要有两种方式：
    - （A）点击页面，触发<link>标签。
    - （B）调用WebView的loadUrl()方法
    - 这两种方法都会发出一条地址，区别就在于这条地址是目的地址还是重定向地址。以访问http://www.baidu.com百度的页面来测试一下方法的执行顺序。


#### 7.1 触发加载网页流程分析
- 在代码中通过loadUrl加载百度的首页，此时的行为属于（B）方式。
    - 可以发现大概的执行顺序是：onPageStarted ——> shouldOverrideUrlLoading ——> onPageFinished
    - 那么为什么会执行多次呢，思考一下？具体可以看一下7.2得出的结论分析。
    ```
    //访问json.cn网页
    2020-06-08 21:03:11.648 28249-28249/com.ycbjie.ycwebview I/X5LogUtils: -------onPageStarted-------https://www.json.cn/
    2020-06-08 21:03:11.656 28249-28249/com.ycbjie.ycwebview I/X5LogUtils: -------onReceivedTitle-------JSON在线解析及格式化验证 - JSON.cn
    2020-06-08 21:03:11.731 28249-28249/com.ycbjie.ycwebview I/X5LogUtils: -------onPageFinished-------https://www.json.cn/

    //访问百度网页
    2020-06-08 21:04:06.969 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -----shouldOverrideUrlLoading------loadUrl-------https://m.baidu.com/?from=844b&vit=fps
    2020-06-08 21:04:07.616 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -------onPageStarted-------https://m.baidu.com/?from=844b&vit=fps
    2020-06-08 21:04:07.618 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -------onReceivedTitle-------百度一下
    2020-06-08 21:04:08.133 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -----shouldOverrideUrlLoading------loadUrl-------http://m.baidu.com/?cip=124.127.44.210&baiduid=E6C897CAF02A1CDBB538FA62922E13E6&from=844b&vit=fps?from=844b&vit=fps&index=&ssid=0&bd_page_type=1&logid=11784780363695702619&pu=sz%401321_480&t_noscript=jump
    2020-06-08 21:04:08.139 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -----shouldOverrideUrlLoading------loadUrl-------https://m.baidu.com/?cip=124.127.44.210&baiduid=E6C897CAF02A1CDBB538FA62922E13E6&from=844b&vit=fps?from=844b&vit=fps&index=&ssid=0&bd_page_type=1&logid=11784780363695702619&pu=sz%401321_480&t_noscript=jump
    2020-06-08 21:04:08.144 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -------onPageFinished-------https://m.baidu.com/?from=844b&vit=fps
    2020-06-08 21:04:08.248 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -------onPageStarted-------https://m.baidu.com/?cip=124.127.44.210&baiduid=E6C897CAF02A1CDBB538FA62922E13E6&from=844b&vit=fps?from=844b&vit=fps&index=&ssid=0&bd_page_type=1&logid=11784780363695702619&pu=sz%401321_480&t_noscript=jump
    2020-06-08 21:04:08.257 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -------onReceivedTitle-------百度一下,你就知道
    2020-06-08 21:04:08.365 28978-28978/com.ycbjie.ycwebview I/X5LogUtils: -------onPageFinished-------https://m.baidu.com/?cip=124.127.44
    ```
- 在首页，点击一下“hao123”,跳转到www.hao123.com的主页上来，此时的行为属于（A）方式。
    - 可以发现大概的执行顺序是：shouldOverrideUrlLoading ——> onPageStarted ——> onPageFinished
    ```
    X5LogUtils: -------shouldOverrideUrlLoading-------http://m.hao123.com/?ssid=0&from=844b&bd_page_type=1&uid=0&pu=sz%401321_1002%2Cta%40utouch_2_9.0_2_6.2&idx=30000&itj=39
    X5LogUtils: -------onPageStarted-------http://m.hao123.com/?ssid=0&from=844b&bd_page_type=1&uid=0&pu=sz%401321_1002%2Cta%40utouch_2_9.0_2_6.2&idx=30000&itj=39
    X5LogUtils: -------onReceivedTitle-------hao123导航-上网从这里开始
    X5LogUtils: -------onPageFinished-------http://m.hao123.com/?ssid=0&from=844b&bd_page_type=1&uid=0&pu=sz%401321_1002%2Cta%40utouch_2_9.0_2_6.2&idx=30000&itj=39
    ```
- 然后在hao123页面，点击优酷网进行跳转，此时的行为属于（A）方式。
    ```
    X5LogUtils: -------shouldOverrideUrlLoading-------http://m.hao123.com/j.php?z=2&page=index_cxv3&pos=cydhwt_n2&category=ty&title=%E4%BC%98%E9%85%B7%E7%BD%91&qt=tz&url=http%3A%2F%2Fwww.youku.com%2F&key=58193753e7a868d9a013056c6c4cd77b
    X5LogUtils: -------onPageStarted-------http://m.hao123.com/j.php?z=2&page=index_cxv3&pos=cydhwt_n2&category=ty&title=%E4%BC%98%E9%85%B7%E7%BD%91&qt=tz&url=http%3A%2F%2Fwww.youku.com%2F&key=58193753e7a868d9a013056c6c4cd77b
    X5LogUtils: -------shouldOverrideUrlLoading-------http://www.youku.com/
    X5LogUtils: -------onPageFinished-------http://m.hao123.com/j.php?z=2&page=index_cxv3&pos=cydhwt_n2&category=ty&title=%E4%BC%98%E9%85%B7%E7%BD%91&qt=tz&url=http%3A%2F%2Fwww.youku.com%2F&key=58193753e7a868d9a013056c6c4cd77b
    X5LogUtils: -------onPageStarted-------http://www.youku.com/
    X5LogUtils: -------shouldOverrideUrlLoading-------https://www.youku.com/
    X5LogUtils: -------onPageFinished-------http://www.youku.com/
    X5LogUtils: -------onPageStarted-------https://www.youku.com/
    X5LogUtils: -------onReceivedTitle-------优酷视频-首页
    X5LogUtils: -------onPageFinished-------https://www.youku.com/
    ```
- 然后从优酷页面回退到hao123页面，看看又回执行哪些方法。
    ```
    X5LogUtils: -------onPageStarted-------http://m.hao123.com/?ssid=0&from=844b&bd_page_type=1&uid=0&pu=sz%401321_1002%2Cta%40utouch_2_9.0_2_6.2&idx=30000&itj=39
    X5LogUtils: -------onReceivedTitle-------hao123导航-上网从这里开始
    X5LogUtils: -------onPageFinished-------http://m.hao123.com/?ssid=0&from=844b&bd_page_type=1&uid=0&pu=sz%401321_1002%2Cta%40utouch_2_9.0_2_6.2&idx=30000&itj=39
    ```
- 然后从hao123页面回退到百度首页，看看又回执行哪些方法。
    ```
    X5LogUtils: -------onPageStarted-------https://m.baidu.com/?cip=117.101.19.67&baiduid=C6FCEED198C994E0D653C094F2708C32&from=844b&vit=fps?from=844b&vit=fps&index=&ssid=0&bd_page_type=1&logid=12175252243175665635&pu=sz%401321_480&t_noscript=jump
    X5LogUtils: -------onReceivedTitle-------百度一下,你就知道
    X5LogUtils: -------onPageFinished-------https://m.baidu.com/?cip=117.101.19.67&baiduid=C6FCEED198C994E0D653C094F2708C32&from=844b&vit=fps?from=844b&vit=fps&index=&ssid=0&bd_page_type=1&logid=12175252243175665635&pu=sz%401321_480&t_noscript=jump
    ```

#### 7.2 得出结论分析说明
- 在(A)行为方式下（用户点击链接的回调）：
    - 1.如果是目的地址，那么方法的执行顺序是：
        - shouldOverrideUrlLoading() -> onPageStarted()-> onPageFinished()
        - shouldOverrideUrlLoading()由于它要提供给APP选择加载网页环境的机会，所以只要是网页上地址请求，都会获取到。
    - 2.如果是重定向地址，在跳转到目的地址之前会进行不断的地址定位，每一次地址定位都会由以下执行顺序体现出来：
        - onPageStarted()->shouldOverrideUrlLoading()->onPageFinished()
        - 暂且设定这种执行顺序叫：fixed position
        - 那么一个正常的重定向地址，方法的执行顺序就是：
        - shouldOverrideUrlLoading() -> fixed position -> … -> fixed position -> onPageStarted() -> onPageFinished()
        - 举个例子：有重定向(A->B->C)，那么
        ```
        shouldOverrideUrlLoading(A) -> onPageStarted(A) -> 
        onPageStarted(B) -> shouldOverrideUrlLoading(B) -> 
        onPageStarted(C) -> shouldOverrideUrlLoading(C) -> onPageFinished(C)
        ```
- 在（B）行为下：
    - 1.如果是目的地址，那么方法的执行顺序是：
        - onPageStarted()-> onPageFinished()
        - loadUrl()加载地址时，一般不会触发shouldOverrideUrlLoading()，一旦触发了，就说明这是一个重定向地址。
    - 2.如果是重定向地址，方法的执行顺序就是：
        - fixed position -> … -> fixed position -> onPageStarted() -> onPageFinished()



#### 7.3 重定向导致的问题
- 如果我们想要自定义进度条，就要考虑如何避免重定向行为造成的多次加载这种情况
- 如果我想想要设置onReceivedTitle中获取到的title标题，就要考虑如何避免重定向行为造成多次加载的这种问题










